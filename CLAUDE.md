# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Tech Stack

- **Framework**: Astro 5.x (Static Site Generator)
- **UI**: React 19.x (Islands Architecture - minimal interactive components only)
- **Styling**: TailwindCSS 4.x (manual integration via @tailwindcss/vite, NO @astrojs/tailwind)
- **Content**: MDX with Content Collections API
- **Code Highlighting**: Shiki (build-time)
- **Comments**: Giscus (GitHub Discussions)
- **TypeScript**: 5.x with strict mode

## Commands

```bash
# Development
pnpm dev                 # Start dev server at localhost:4321
pnpm build              # Production build to ./dist/
pnpm preview            # Preview production build

# Code Quality
pnpm lint               # Run ESLint
pnpm lint:fix           # Fix ESLint issues
pnpm format             # Format with Prettier
pnpm format:check       # Check Prettier formatting
pnpm check              # TypeScript type checking (astro check)
```

## Architecture

### Astro Islands Pattern

- **Astro Components** (`.astro`): Static components with 0 bytes JS by default
- **React Components** (`.tsx`): Only for interactive features that need state/events
- Use `client:load` or `client:idle` directives sparingly

### Component Classification Rules

- **React (.tsx)**: Components with useState, useEffect, onClick handlers
- **Astro (.astro)**: Everything else (layouts, static UI, wrappers)
- Current React components: None (search feature postponed due to React 19 compatibility)

### Content Management

- **Blog Posts**: `src/content/blog/*.mdx` - MDX files with frontmatter
- **Content Schema**: Defined in `src/content/config.ts` using Zod
- **Categories**: Defined in `src/content/categories.json`
- **Access**: Use `getCollection("blog")` from `astro:content`

### Styling Approach

- **NO embedded `<style>` tags or @apply directives**
- **Use inline TailwindCSS utility classes only**
- **Exception**: `src/styles/global.css` for MDX prose styles (`.prose h2`, `.prose p`, etc.)
- **NO dark mode**: All dark mode code has been removed

### URL Structure

- Posts: `/posts/[slug]`
- Categories: `/categories/[category]` (lowercase)
- Tags: `/tags/[tag]` (lowercase)
- RSS: `/rss.xml`
- Sitemap: Auto-generated by @astrojs/sitemap

### Key Files

- `astro.config.mjs`: Site URL (https://ywc.life), integrations, Shiki config
- `src/content/config.ts`: Content Collections schema
- `src/content/categories.json`: Available categories
- `src/layouts/BaseLayout.astro`: Base HTML structure, SEO component
- `src/components/astro/SEO.astro`: Reusable SEO meta tags (OG, Twitter Card)

## Development Constraints

- **No SSR**: Static generation only (`astro build`)
- **Build-time processing**: MDX, Shiki, image optimization all at build time
- **No state management libraries**: Use Astro's built-in features
- **No dark mode**: Removed for simplicity
- **Search feature postponed**: React 19 + @astrojs/react compatibility issues

## Deployment

### Vercel (Recommended)

Project is configured for Vercel deployment:

- **Site URL**: https://ywc.life (set in `astro.config.mjs`)
- **Build Command**: `pnpm build`
- **Output Directory**: `dist`
- **Install Command**: `pnpm install`

Optional `vercel.json`:

```json
{
  "buildCommand": "pnpm build",
  "devCommand": "pnpm dev",
  "installCommand": "pnpm install",
  "framework": "astro",
  "outputDirectory": "dist"
}
```

### Before First Deploy

Update Giscus comments configuration in `src/components/astro/Comments.astro`:

```typescript
const repo = "your-username/your-repo"; // Replace with actual repo
const repoId = "R_kgDOxxxxxx"; // Get from https://giscus.app
const categoryId = "DIC_kwDOxxxxxx"; // Get from https://giscus.app
```

Comments will not work until these values are configured.

## Known Issues

- React 19 with @astrojs/react may have compatibility issues with hooks
- Search/filter features are postponed until React compatibility is resolved
- Giscus comments require manual configuration before deployment

<!-- MANUAL ADDITIONS START -->
<!-- MANUAL ADDITIONS END -->
